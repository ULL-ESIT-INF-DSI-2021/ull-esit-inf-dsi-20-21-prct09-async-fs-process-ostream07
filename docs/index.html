<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>ull-esit-inf-dsi-20-21-prct09-async-fs-process-ostream07</title>
	<meta name="description" content="Documentation for ull-esit-inf-dsi-20-21-prct09-async-fs-process-ostream07">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="assets/css/main.css">
	<script async src="assets/js/search.js" id="search-script"></script>
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="assets/js/search.json" data-base=".">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="index.html" class="title">ull-esit-inf-dsi-20-21-prct09-async-fs-process-ostream07</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
							<input type="checkbox" id="tsd-filter-externals" checked />
							<label class="tsd-widget" for="tsd-filter-externals">Externals</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<h1>ull-esit-inf-dsi-20-21-prct09-async-fs-process-ostream07</h1>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-8 col-content">
			<div class="tsd-panel tsd-typography">
				<a href="#desarrollo-de-sistemas-informáticos" id="desarrollo-de-sistemas-informáticos" style="color: inherit; text-decoration: none;">
					<h1>Desarrollo de Sistemas Informáticos</h1>
				</a>
				<a href="#práctica-9-sistema-de-ficheros-y-creación-de-procesos-en-nodejs" id="práctica-9-sistema-de-ficheros-y-creación-de-procesos-en-nodejs" style="color: inherit; text-decoration: none;">
					<h3>Práctica 9. Sistema de ficheros y creación de procesos en Node.js</h3>
				</a>
				<ul>
					<li>Autor: Saúl Pérez García</li>
					<li>Correo: <a href="mailto:alu0101129785@ull.edu.es">alu0101129785@ull.edu.es</a></li>
					<li>Fecha de entrega: 02-05-2021</li>
				</ul>
				<a href="#--gt-introducción" id="--gt-introducción" style="color: inherit; text-decoration: none;">
					<h3>--&gt; Introducción</h3>
				</a>
				<p>En esta práctica se plantean la implementación de una serie de ejercicios haciendo uso de las APIs proporcionadas por Node.js para interactuar con el sistema de ficheros, así como para crear procesos.</p>
				<p>El código desarrolado será documentado con <strong>typedoc</strong>. Como en las prácticas anteriores, se hará uso de <strong>GitHub Actions</strong> que nos va a permitir automatizar, personalizar y ejecutar nuestros flujos de trabajo de desarrollo de software directamente en el repositorio.</p>
				<p>Antes de continuar, es conveniente revisar la documentación que se adjunta a continuación sobre la <strong>API de callbacks proporcionada por Node.js</strong> para interactuar con el sistema de ficheros y el <strong>API asíncrona proporcionada por Node.js</strong> para crear procesos y, en concreto, con la función <strong>spawn</strong>.</p>
				<p>También podremos encontrar información referida a la <strong>API síncrona de Node.js</strong> para trabajar con el sistema de ficheros, ya que tenemos la intención de guardar el contenido de las notas en diferentes ficheros.</p>
				<ul>
					<li><a href="https://www.npmjs.com/package/@types/node">Node.js</a></li>
					<li><a href="https://nodejs.org/dist/latest/docs/api/fs.html#fs_callback_api">API de callbacks proporcionada por Node.js</a></li>
					<li><a href="https://nodejs.org/dist/latest/docs/api/child_process.html#child_process_asynchronous_process_creation">API asíncrona proporcionada por Node.js</a></li>
					<li><a href="https://nodejs.org/dist/latest/docs/api/child_process.html#child_process_child_process_spawn_command_args_options">Función spawn</a></li>
				</ul>
				<a href="#------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------" id="------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------" style="color: inherit; text-decoration: none;">
					<h1>------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</h1>
				</a>
				<a href="#--gt-ejercicio-1" id="--gt-ejercicio-1" style="color: inherit; text-decoration: none;">
					<h4>--&gt; Ejercicio 1</h4>
				</a>
				<p>Realizar una traza teniendo en cuenta el siguiente código:</p>
				<pre><code><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">access</span><span style="color: #000000">, </span><span style="color: #001080">constants</span><span style="color: #000000">, </span><span style="color: #001080">watch</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;fs&#039;</span><span style="color: #000000">;</span>

<span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #001080">process</span><span style="color: #000000">.</span><span style="color: #001080">argv</span><span style="color: #000000">.</span><span style="color: #001080">length</span><span style="color: #000000"> !== </span><span style="color: #098658">3</span><span style="color: #000000">) {</span>
<span style="color: #000000">  </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;Please, specify a file&#039;</span><span style="color: #000000">);</span>
<span style="color: #000000">} </span><span style="color: #AF00DB">else</span><span style="color: #000000"> {</span>
<span style="color: #000000">  </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">filename</span><span style="color: #000000"> = </span><span style="color: #001080">process</span><span style="color: #000000">.</span><span style="color: #001080">argv</span><span style="color: #000000">[</span><span style="color: #098658">2</span><span style="color: #000000">];</span>

<span style="color: #000000">  </span><span style="color: #795E26">access</span><span style="color: #000000">(</span><span style="color: #001080">filename</span><span style="color: #000000">, </span><span style="color: #001080">constants</span><span style="color: #000000">.</span><span style="color: #0070C1">F_OK</span><span style="color: #000000">, (</span><span style="color: #001080">err</span><span style="color: #000000">) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #001080">err</span><span style="color: #000000">) {</span>
<span style="color: #000000">      </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #A31515">`File </span><span style="color: #0000FF">${</span><span style="color: #001080">filename</span><span style="color: #0000FF">}</span><span style="color: #A31515"> does not exist`</span><span style="color: #000000">);</span>
<span style="color: #000000">    } </span><span style="color: #AF00DB">else</span><span style="color: #000000"> {</span>
<span style="color: #000000">      </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #A31515">`Starting to watch file </span><span style="color: #0000FF">${</span><span style="color: #001080">filename</span><span style="color: #0000FF">}</span><span style="color: #A31515">`</span><span style="color: #000000">);</span>

<span style="color: #000000">      </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">watcher</span><span style="color: #000000"> = </span><span style="color: #795E26">watch</span><span style="color: #000000">(</span><span style="color: #001080">process</span><span style="color: #000000">.</span><span style="color: #001080">argv</span><span style="color: #000000">[</span><span style="color: #098658">2</span><span style="color: #000000">]);</span>

<span style="color: #000000">      </span><span style="color: #001080">watcher</span><span style="color: #000000">.</span><span style="color: #795E26">on</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;change&#039;</span><span style="color: #000000">, () </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">        </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #A31515">`File </span><span style="color: #0000FF">${</span><span style="color: #001080">filename</span><span style="color: #0000FF">}</span><span style="color: #A31515"> has been modified somehow`</span><span style="color: #000000">);</span>
<span style="color: #000000">      });</span>

<span style="color: #000000">      </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #A31515">`File </span><span style="color: #0000FF">${</span><span style="color: #001080">filename</span><span style="color: #0000FF">}</span><span style="color: #A31515"> is no longer watched`</span><span style="color: #000000">);</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">  });</span>
<span style="color: #000000">}</span>
</code></pre>
				<p>Al iniciarse el proceso, main pasa a la pila de llamadas</p>
				<a href="#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------1" id="-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------1" style="color: inherit; text-decoration: none;">
					<h1>------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</h1>
				</a>
				<a href="#--gt-ejercicio-2" id="--gt-ejercicio-2" style="color: inherit; text-decoration: none;">
					<h4>--&gt; Ejercicio 2</h4>
				</a>
				<p>El objetivo de este ejercicio es conseguir llevar a implementar una aplicación que logre un funcionamiento similar al del comando wc y sus diversas opciones tal y como podemos usar si consultamos su manual:</p>
				<pre><code><span style="color: #000000">Usage: </span><span style="color: #001080">wc</span><span style="color: #000000"> [</span><span style="color: #0070C1">OPTION</span><span style="color: #000000">]... [</span><span style="color: #0070C1">FILE</span><span style="color: #000000">]...</span>
<span style="color: #000000">  or:  </span><span style="color: #001080">wc</span><span style="color: #000000"> [</span><span style="color: #0070C1">OPTION</span><span style="color: #000000">]... --</span><span style="color: #001080">files0</span><span style="color: #000000">-</span><span style="color: #001080">from</span><span style="color: #000000">=</span><span style="color: #0070C1">F</span>
<span style="color: #001080">Print</span><span style="color: #000000"> </span><span style="color: #001080">newline</span><span style="color: #000000">, </span><span style="color: #001080">word</span><span style="color: #000000">, </span><span style="color: #001080">and</span><span style="color: #000000"> </span><span style="color: #001080">byte</span><span style="color: #000000"> </span><span style="color: #001080">counts</span><span style="color: #000000"> </span><span style="color: #001080">for</span><span style="color: #000000"> </span><span style="color: #001080">each</span><span style="color: #000000"> </span><span style="color: #0070C1">FILE</span><span style="color: #000000">, </span><span style="color: #001080">and</span><span style="color: #000000"> </span><span style="color: #001080">a</span><span style="color: #000000"> </span><span style="color: #001080">total</span><span style="color: #000000"> </span><span style="color: #001080">line</span><span style="color: #000000"> </span><span style="color: #AF00DB">if</span>
<span style="color: #001080">more</span><span style="color: #000000"> </span><span style="color: #001080">than</span><span style="color: #000000"> </span><span style="color: #001080">one</span><span style="color: #000000"> </span><span style="color: #0070C1">FILE</span><span style="color: #000000"> </span><span style="color: #001080">is</span><span style="color: #000000"> </span><span style="color: #001080">specified</span><span style="color: #000000">.  </span><span style="color: #0070C1">A</span><span style="color: #000000"> </span><span style="color: #001080">word</span><span style="color: #000000"> </span><span style="color: #001080">is</span><span style="color: #000000"> </span><span style="color: #001080">a</span><span style="color: #000000"> </span><span style="color: #001080">non</span><span style="color: #000000">-</span><span style="color: #001080">zero</span><span style="color: #000000">-</span><span style="color: #001080">length</span><span style="color: #000000"> </span><span style="color: #001080">sequence</span><span style="color: #000000"> </span><span style="color: #0000FF">of</span>
<span style="color: #001080">characters</span><span style="color: #000000"> </span><span style="color: #001080">delimited</span><span style="color: #000000"> </span><span style="color: #001080">by</span><span style="color: #000000"> </span><span style="color: #001080">white</span><span style="color: #000000"> </span><span style="color: #001080">space</span><span style="color: #000000">.</span>

<span style="color: #001080">With</span><span style="color: #000000"> </span><span style="color: #001080">no</span><span style="color: #000000"> </span><span style="color: #0070C1">FILE</span><span style="color: #000000">, </span><span style="color: #001080">or</span><span style="color: #000000"> </span><span style="color: #001080">when</span><span style="color: #000000"> </span><span style="color: #0070C1">FILE</span><span style="color: #000000"> </span><span style="color: #001080">is</span><span style="color: #000000"> -, </span><span style="color: #001080">read</span><span style="color: #000000"> </span><span style="color: #001080">standard</span><span style="color: #000000"> </span><span style="color: #001080">input</span><span style="color: #000000">.</span>

<span style="color: #001080">The</span><span style="color: #000000"> </span><span style="color: #001080">options</span><span style="color: #000000"> </span><span style="color: #001080">below</span><span style="color: #000000"> </span><span style="color: #001080">may</span><span style="color: #000000"> </span><span style="color: #001080">be</span><span style="color: #000000"> </span><span style="color: #001080">used</span><span style="color: #000000"> </span><span style="color: #001080">to</span><span style="color: #000000"> </span><span style="color: #001080">select</span><span style="color: #000000"> </span><span style="color: #001080">which</span><span style="color: #000000"> </span><span style="color: #001080">counts</span><span style="color: #000000"> </span><span style="color: #001080">are</span><span style="color: #000000"> </span><span style="color: #001080">printed</span><span style="color: #000000">, </span><span style="color: #001080">always</span><span style="color: #000000"> </span><span style="color: #0000FF">in</span>
<span style="color: #001080">the</span><span style="color: #000000"> </span><span style="color: #001080">following</span><span style="color: #000000"> order: </span><span style="color: #001080">newline</span><span style="color: #000000">, </span><span style="color: #001080">word</span><span style="color: #000000">, </span><span style="color: #001080">character</span><span style="color: #000000">, </span><span style="color: #001080">byte</span><span style="color: #000000">, </span><span style="color: #001080">maximum</span><span style="color: #000000"> </span><span style="color: #001080">line</span><span style="color: #000000"> </span><span style="color: #001080">length</span><span style="color: #000000">.</span>
<span style="color: #000000">  -</span><span style="color: #001080">c</span><span style="color: #000000">, --</span><span style="color: #001080">bytes</span><span style="color: #000000">            </span><span style="color: #001080">print</span><span style="color: #000000"> </span><span style="color: #001080">the</span><span style="color: #000000"> </span><span style="color: #001080">byte</span><span style="color: #000000"> </span><span style="color: #001080">counts</span>
<span style="color: #000000">  -</span><span style="color: #001080">m</span><span style="color: #000000">, --</span><span style="color: #001080">chars</span><span style="color: #000000">            </span><span style="color: #001080">print</span><span style="color: #000000"> </span><span style="color: #001080">the</span><span style="color: #000000"> </span><span style="color: #001080">character</span><span style="color: #000000"> </span><span style="color: #001080">counts</span>
<span style="color: #000000">  -</span><span style="color: #001080">l</span><span style="color: #000000">, --</span><span style="color: #001080">lines</span><span style="color: #000000">            </span><span style="color: #001080">print</span><span style="color: #000000"> </span><span style="color: #001080">the</span><span style="color: #000000"> </span><span style="color: #001080">newline</span><span style="color: #000000"> </span><span style="color: #001080">counts</span>
<span style="color: #000000">      --</span><span style="color: #001080">files0</span><span style="color: #000000">-</span><span style="color: #001080">from</span><span style="color: #000000">=</span><span style="color: #0070C1">F</span><span style="color: #000000">    </span><span style="color: #001080">read</span><span style="color: #000000"> </span><span style="color: #001080">input</span><span style="color: #000000"> </span><span style="color: #001080">from</span><span style="color: #000000"> </span><span style="color: #001080">the</span><span style="color: #000000"> </span><span style="color: #001080">files</span><span style="color: #000000"> </span><span style="color: #001080">specified</span><span style="color: #000000"> </span><span style="color: #001080">by</span>
<span style="color: #000000">                           </span><span style="color: #0070C1">NUL</span><span style="color: #000000">-</span><span style="color: #001080">terminated</span><span style="color: #000000"> </span><span style="color: #001080">names</span><span style="color: #000000"> </span><span style="color: #0000FF">in</span><span style="color: #000000"> </span><span style="color: #001080">file</span><span style="color: #000000"> </span><span style="color: #0070C1">F</span><span style="color: #000000">;</span>
<span style="color: #000000">                           </span><span style="color: #001080">If</span><span style="color: #000000"> </span><span style="color: #0070C1">F</span><span style="color: #000000"> </span><span style="color: #001080">is</span><span style="color: #000000"> - </span><span style="color: #001080">then</span><span style="color: #000000"> </span><span style="color: #001080">read</span><span style="color: #000000"> </span><span style="color: #001080">names</span><span style="color: #000000"> </span><span style="color: #001080">from</span><span style="color: #000000"> </span><span style="color: #001080">standard</span><span style="color: #000000"> </span><span style="color: #001080">input</span>
<span style="color: #000000">  -</span><span style="color: #0070C1">L</span><span style="color: #000000">, --</span><span style="color: #001080">max</span><span style="color: #000000">-</span><span style="color: #001080">line</span><span style="color: #000000">-</span><span style="color: #001080">length</span><span style="color: #000000">  </span><span style="color: #001080">print</span><span style="color: #000000"> </span><span style="color: #001080">the</span><span style="color: #000000"> </span><span style="color: #001080">maximum</span><span style="color: #000000"> </span><span style="color: #001080">display</span><span style="color: #000000"> </span><span style="color: #001080">width</span>
<span style="color: #000000">  -</span><span style="color: #001080">w</span><span style="color: #000000">, --</span><span style="color: #001080">words</span><span style="color: #000000">            </span><span style="color: #001080">print</span><span style="color: #000000"> </span><span style="color: #001080">the</span><span style="color: #000000"> </span><span style="color: #001080">word</span><span style="color: #000000"> </span><span style="color: #001080">counts</span>
<span style="color: #000000">      --</span><span style="color: #001080">help</span><span style="color: #000000">     </span><span style="color: #001080">display</span><span style="color: #000000"> </span><span style="color: #0000FF">this</span><span style="color: #000000"> </span><span style="color: #001080">help</span><span style="color: #000000"> </span><span style="color: #001080">and</span><span style="color: #000000"> </span><span style="color: #001080">exit</span>
<span style="color: #000000">      --</span><span style="color: #001080">version</span><span style="color: #000000">  </span><span style="color: #001080">output</span><span style="color: #000000"> </span><span style="color: #001080">version</span><span style="color: #000000"> </span><span style="color: #001080">information</span><span style="color: #000000"> </span><span style="color: #001080">and</span><span style="color: #000000"> </span><span style="color: #001080">exit</span>
</code></pre>
				<p>Es decir, necesitaremos de una aplicación que proporcione información sobre el número de líneas, palabras o caracteres que contiene un fichero de texto. La ruta donde se encuentra el fichero debe ser un parámetro pasado a la aplicación desde la línea de comandos. Adicionalmente, también deberá indicarle al programa desde la línea de comandos si desea visualizar el número de líneas, palabras, caracteres o combinaciones de ellas. Puede gestionar el paso de parámetros desde la línea de comandos haciendo uso de yargs.</p>
				<p>Además, debemos conseguir esto de dos formas diferentes: </p>
				<ol>
					<li>Haciendo uso del método pipe de un Stream para poder redirigir la salida de un comando hacia otro.</li>
					<li>Sin hacer uso del método pipe, solamente creando los subprocesos necesarios y registrando manejadores a aquellos eventos necesarios para implementar la funcionalidad solicitada. Se recomienda la lectura de la documentación de <a href="https://nodejs.org/api/stream.html">Stream</a> para el desarrolo de este ejercicio. </li>
				</ol>
				<p>Por último, se debe realizar una programación defensiva, es decir, trate de controlar los potenciales errores que podrían surgir a la hora de ejecutar su programa. </p>
				<p>Por ejemplo, ¿qué sucede si indica desde la línea de comandos un fichero que no existe o una opción no válida?</p>
				<p>Para resolver este ejercicio y mediante el uso de <strong>yargs</strong>, se han creado dos comandos, <code>pipe</code> y <code>event</code>.</p>
				<p>Pipe, es un comando, que va a requerir como argumento obligatorio una ruta donde se deberá encontrar el fichero a analizar y luego podremos apsarle varios parámetros opciones siendo estos ``--lines<code>para contar las líneas del fichero,</code>--words<code>para contar las palabras que lo conforman o</code>--characters` para ver el número exacto de caracteres del mismo.</p>
				<p>Los parámetros serán almacenados en un vecor de strings donde se irán haciendo push detro del mismo de cada uno de estos comandos si estos son empleados para luego ser usados por la función <code>spawn</code>, que nos devolverá un <strong>child_process</strong>. Su método de uso es <code>spawn(&#39;commad&#39;, [list with the command options, &#39;route&#39;]);</code>.
				En nuestro caso, vamos a crear una variable nueva, llamada <code>subprocess</code> de tipo <code>ChildProcessWithoutNullStreams</code> que va a recoger el spawn que tendrá como string el comando a usar que es <code>wc</code> y luego entre corchetes, el vector de strings que había rellenado, finalmente, le pasaremos la ruta donde va a estar el fichero a analizar. Para compilar cada uno de los ficheros, podemos ir al package.json y editar el script build y luego ejecutar <code>npm run build</code>. Veamos el fragmento de código:</p>
				<pre><code><span style="color: #000000">      </span><span style="color: #0000FF">let</span><span style="color: #000000"> </span><span style="color: #001080">subprocess</span><span style="color: #000000"> = </span><span style="color: #795E26">spawn</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;wc&#039;</span><span style="color: #000000">, [...</span><span style="color: #001080">args</span><span style="color: #000000">, </span><span style="color: #001080">argv</span><span style="color: #000000">.</span><span style="color: #001080">route</span><span style="color: #000000">]);</span>
<span style="color: #000000">      </span><span style="color: #001080">subprocess</span><span style="color: #000000">.</span><span style="color: #795E26">on</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;error&#039;</span><span style="color: #000000">, () </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">        </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;Error with the command&#039;</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #001080">process</span><span style="color: #000000">.</span><span style="color: #795E26">exit</span><span style="color: #000000">(-</span><span style="color: #098658">1</span><span style="color: #000000">);</span>
<span style="color: #000000">      });</span>

<span style="color: #000000">      </span><span style="color: #001080">subprocess</span><span style="color: #000000">.</span><span style="color: #001080">stdout</span><span style="color: #000000">.</span><span style="color: #795E26">pipe</span><span style="color: #000000">(</span><span style="color: #001080">process</span><span style="color: #000000">.</span><span style="color: #001080">stdout</span><span style="color: #000000">);</span>
<span style="color: #000000">      </span><span style="color: #001080">subprocess</span><span style="color: #000000">.</span><span style="color: #001080">stderr</span><span style="color: #000000">.</span><span style="color: #795E26">pipe</span><span style="color: #000000">(</span><span style="color: #001080">process</span><span style="color: #000000">.</span><span style="color: #001080">stderr</span><span style="color: #000000">);</span>

<span style="color: #000000">      </span><span style="color: #001080">subprocess</span><span style="color: #000000">.</span><span style="color: #795E26">on</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;close&#039;</span><span style="color: #000000">, (</span><span style="color: #001080">code</span><span style="color: #000000">) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">        </span><span style="color: #AF00DB">if</span><span style="color: #000000">(</span><span style="color: #001080">code</span><span style="color: #000000">) {</span>
<span style="color: #000000">          </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;Command exited with code &#039;</span><span style="color: #000000"> + </span><span style="color: #001080">code</span><span style="color: #000000">);</span>
<span style="color: #000000">        }</span>
<span style="color: #000000">        </span><span style="color: #001080">process</span><span style="color: #000000">.</span><span style="color: #795E26">exit</span><span style="color: #000000">(</span><span style="color: #001080">code</span><span style="color: #000000">);</span>
<span style="color: #000000">      });</span>
</code></pre>
				<p>Aquí vemos además la callback en caso de error, tanto por un problema con el comando o porque el fichero no existe o se ha utilizado una opción no válida. En estos casos, redirigiríamos la salida del error como un error nuestro. Es decir, cuando este pograma falla, ahora se muestra un error indicando el motivo, debido a que se ha redigirido la salida del mismo como un error nuestro y que es mostrado por pantalla con el uso de <code>pipe</code> resolviendo de esta forma la pregunta formulada en el guión. Veamos unos ejemplos de ejecución:</p>
				<pre><code><span style="color: #001080">node</span><span style="color: #000000"> </span><span style="color: #001080">src</span><span style="color: #000000">/</span><span style="color: #001080">exercise</span><span style="color: #000000">-2.</span><span style="color: #001080">js</span><span style="color: #000000"> </span><span style="color: #001080">pipe</span><span style="color: #000000"> --</span><span style="color: #001080">route</span><span style="color: #000000"> </span><span style="color: #0070C1">README</span><span style="color: #000000">.</span><span style="color: #001080">txt</span><span style="color: #000000"> --</span><span style="color: #001080">lines</span><span style="color: #000000"> --</span><span style="color: #001080">words</span><span style="color: #000000"> --</span><span style="color: #001080">characters</span>
<span style="color: #000000">wc: </span><span style="color: #0070C1">README</span><span style="color: #000000">.</span><span style="color: #001080">txt</span><span style="color: #000000">: </span><span style="color: #001080">No</span><span style="color: #000000"> </span><span style="color: #001080">existe</span><span style="color: #000000"> </span><span style="color: #001080">el</span><span style="color: #000000"> </span><span style="color: #001080">archivo</span><span style="color: #000000"> </span><span style="color: #001080">o</span><span style="color: #000000"> </span><span style="color: #001080">el</span><span style="color: #000000"> </span><span style="color: #001080">directorio</span>
<span style="color: #001080">Command</span><span style="color: #000000"> </span><span style="color: #001080">exited</span><span style="color: #000000"> </span><span style="color: #AF00DB">with</span><span style="color: #000000"> </span><span style="color: #001080">code</span><span style="color: #000000"> </span><span style="color: #098658">1</span>
</code></pre>
				<p>El fichero README.txt no existe y por tanto, se lanza el error.</p>
				<pre><code><span style="color: #001080">node</span><span style="color: #000000"> </span><span style="color: #001080">src</span><span style="color: #000000">/</span><span style="color: #001080">exercise</span><span style="color: #000000">-2.</span><span style="color: #001080">js</span><span style="color: #000000"> </span><span style="color: #001080">event</span><span style="color: #000000"> --</span><span style="color: #001080">route</span><span style="color: #000000"> </span><span style="color: #0070C1">README</span><span style="color: #000000">.</span><span style="color: #001080">md</span><span style="color: #000000"> --</span><span style="color: #001080">lines</span><span style="color: #000000"> --</span><span style="color: #001080">words</span><span style="color: #000000"> --</span><span style="color: #001080">characters</span>
<span style="color: #000000">  </span><span style="color: #098658">262</span><span style="color: #000000">  </span><span style="color: #098658">2128</span><span style="color: #000000"> </span><span style="color: #098658">17276</span><span style="color: #000000"> </span><span style="color: #0070C1">README</span><span style="color: #000000">.</span><span style="color: #001080">md</span>
</code></pre>
				<pre><code><span style="color: #001080">node</span><span style="color: #000000"> </span><span style="color: #001080">src</span><span style="color: #000000">/</span><span style="color: #001080">exercise</span><span style="color: #000000">-2.</span><span style="color: #001080">js</span><span style="color: #000000"> </span><span style="color: #001080">pipe</span><span style="color: #000000"> --</span><span style="color: #001080">route</span><span style="color: #000000"> </span><span style="color: #0070C1">README</span><span style="color: #000000">.</span><span style="color: #001080">md</span><span style="color: #000000"> --</span><span style="color: #001080">lines</span><span style="color: #000000"> --</span><span style="color: #001080">words</span><span style="color: #000000"> --</span><span style="color: #001080">characters</span>
<span style="color: #000000">  </span><span style="color: #098658">262</span><span style="color: #000000">  </span><span style="color: #098658">2128</span><span style="color: #000000"> </span><span style="color: #098658">17276</span><span style="color: #000000"> </span><span style="color: #0070C1">README</span><span style="color: #000000">.</span><span style="color: #001080">md</span>
</code></pre>
				<p>Se puede ver como en ambos casos muestra el mismo número de líneas, palabras y caracteres que tenía en ese momento el README.md.</p>
				<a href="#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------2" id="-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------2" style="color: inherit; text-decoration: none;">
					<h1>------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</h1>
				</a>
				<a href="#--gt-ejercicio-3" id="--gt-ejercicio-3" style="color: inherit; text-decoration: none;">
					<h4>--&gt; Ejercicio 3</h4>
				</a>
				<p>A partir de la aplicación de procesamiento de notas desarrollada en la práctica anterior, tenemos que conseguir una aplicación que reciba desde la línea de comandos el nombre de un usuario de la aplicación de notas, así como la ruta donde se almacenan las notas de dicho usuario.
					Gestionaremos los parámetros desde la línea de comandos haciendo uso de yargs. La aplicación a desarrollar deberá controlar los cambios realizados sobre todo el directorio especificado al mismo tiempo que dicho usuario interactúa con la aplicación de procesamiento de notas. Nótese que no hace falta modificar absolutamente nada en la aplicación de procesamiento de notas. Es una aplicación que se va a utilizar para provocar cambios en el sistema de ficheros.
				Su funcionamiento será simple, en una terminal usaremos <a href="https://nodejs.org/dist/latest/docs/api/fs.html#fs_fs_watch_filename_options_listener">watch</a> para escuchar, mientras que en la otra tendremos abierta la práctca anterior realizando cambios en las notas y podremos ver que esto nos lo reflejará la función watch por la terminal.</p>
				<p>Con cada cambio detectado en el directorio observado, el programa debe emitir un <strong>Watcher</strong> para indicar si se ha añadido, modificado o borrado una nota, además de indicar el nombre concreto del fichero creado, modificado o eliminado para alojar dicha nota. Veamos un fragmento del código:</p>
				<pre><code><span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #0000FF">typeof</span><span style="color: #000000"> </span><span style="color: #001080">argv</span><span style="color: #000000">.</span><span style="color: #001080">route</span><span style="color: #000000"> === </span><span style="color: #A31515">&#039;string&#039;</span><span style="color: #000000"> &amp;&amp; </span><span style="color: #0000FF">typeof</span><span style="color: #000000"> </span><span style="color: #001080">argv</span><span style="color: #000000">.</span><span style="color: #001080">user</span><span style="color: #000000"> === </span><span style="color: #A31515">&#039;string&#039;</span><span style="color: #000000">) {</span>
<span style="color: #000000">      </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">directoryName</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000"> = </span><span style="color: #001080">argv</span><span style="color: #000000">.</span><span style="color: #001080">route</span><span style="color: #000000">;</span>
<span style="color: #000000">      </span><span style="color: #795E26">access</span><span style="color: #000000">(</span><span style="color: #001080">argv</span><span style="color: #000000">.</span><span style="color: #001080">route</span><span style="color: #000000">, </span><span style="color: #001080">constants</span><span style="color: #000000">.</span><span style="color: #0070C1">F_OK</span><span style="color: #000000">, (</span><span style="color: #001080">err</span><span style="color: #000000">) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">        </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #001080">err</span><span style="color: #000000">) {</span>
<span style="color: #000000">          </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #A31515">`Directory </span><span style="color: #0000FF">${</span><span style="color: #001080">directoryName</span><span style="color: #0000FF">}</span><span style="color: #A31515"> does not exist!`</span><span style="color: #000000">);</span>
<span style="color: #000000">        } </span><span style="color: #AF00DB">else</span><span style="color: #000000"> {</span>
<span style="color: #000000">          </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">watcher</span><span style="color: #000000"> = </span><span style="color: #795E26">watch</span><span style="color: #000000">(</span><span style="color: #001080">directoryName</span><span style="color: #000000">);</span>

<span style="color: #000000">          </span><span style="color: #001080">watcher</span><span style="color: #000000">.</span><span style="color: #795E26">on</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;change&#039;</span><span style="color: #000000">, (</span><span style="color: #001080">eventType</span><span style="color: #000000">, </span><span style="color: #001080">fileName</span><span style="color: #000000">) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">            </span><span style="color: #AF00DB">switch</span><span style="color: #000000"> (</span><span style="color: #001080">eventType</span><span style="color: #000000">) {</span>
<span style="color: #000000">              </span><span style="color: #AF00DB">case</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;rename&#039;</span><span style="color: #000000">:</span>
<span style="color: #000000">                </span><span style="color: #795E26">access</span><span style="color: #000000">(</span><span style="color: #795E26">join</span><span style="color: #000000">(</span><span style="color: #001080">directoryName</span><span style="color: #000000">, </span><span style="color: #001080">fileName</span><span style="color: #000000">.</span><span style="color: #795E26">toString</span><span style="color: #000000">()), </span><span style="color: #001080">constants</span><span style="color: #000000">.</span><span style="color: #0070C1">F_OK</span><span style="color: #000000">, (</span><span style="color: #001080">err</span><span style="color: #000000">) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">                  </span><span style="color: #AF00DB">if</span><span style="color: #000000">(</span><span style="color: #001080">err</span><span style="color: #000000">) {</span>
<span style="color: #000000">                    </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #A31515">`File </span><span style="color: #0000FF">${</span><span style="color: #001080">fileName</span><span style="color: #0000FF">}</span><span style="color: #A31515"> was deleted`</span><span style="color: #000000">);</span>
<span style="color: #000000">                  } </span><span style="color: #AF00DB">else</span><span style="color: #000000"> {</span>
<span style="color: #000000">                    </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #A31515">`File </span><span style="color: #0000FF">${</span><span style="color: #001080">fileName</span><span style="color: #0000FF">}</span><span style="color: #A31515"> was created`</span><span style="color: #000000">);</span>
<span style="color: #000000">                  }</span>
<span style="color: #000000">                });</span>
<span style="color: #000000">              </span><span style="color: #AF00DB">case</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;change&#039;</span><span style="color: #000000">:</span>
<span style="color: #000000">                </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #A31515">`File </span><span style="color: #0000FF">${</span><span style="color: #001080">fileName</span><span style="color: #0000FF">}</span><span style="color: #A31515"> was modified`</span><span style="color: #000000">);</span>
<span style="color: #000000">            }</span>
<span style="color: #000000">          });</span>
<span style="color: #000000">        }</span>
<span style="color: #000000">      });</span>
<span style="color: #000000">    }</span>
</code></pre>
				<p>Apoyándonos en yargs, vamos a tener un comando llamado <strong>watch</strong> que necesitará obligatoriamente de dos prámetros, uno con la ruta de lo que vamos a escuchar y el nombre del usuario de este directorio. Lo primero que haremos, será comprobar si el directorio existe y sino, lanzar un mensaje de error. Una vez superado este punto, vamos a tener dos tipos de eventos que se pueden emitir, un evento de tipo <code>rename</code> siempre que el fichero sea borrado o eliminado o un evento tipo <code>change</code> que saldrá en caso de que el objetivo que estamos observando sea modificado.</p>
				<p>Veamos un ejemplo de ejecución:</p>
				<pre><code><span style="color: #001080">Terminal</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000">:</span>

<span style="color: #001080">node</span><span style="color: #000000"> </span><span style="color: #001080">src</span><span style="color: #000000">/</span><span style="color: #001080">exercise</span><span style="color: #000000">-3.</span><span style="color: #001080">js</span><span style="color: #000000"> </span><span style="color: #001080">watch</span><span style="color: #000000"> --</span><span style="color: #001080">route</span><span style="color: #000000"> ../../</span><span style="color: #001080">prueba</span><span style="color: #000000">/</span><span style="color: #001080">edusegre</span><span style="color: #000000"> --</span><span style="color: #001080">user</span><span style="color: #000000">=</span><span style="color: #001080">edusegre</span>
</code></pre>
				<p>Al ejecutar este comando, se mantiene esperando que algo cambie en la ruta que le hemos proporcioando, vamos a ver que pasa si abrimos otra terminal y realizamos un cambio:</p>
				<pre><code><span style="color: #001080">Terminal</span><span style="color: #000000"> </span><span style="color: #098658">2</span><span style="color: #000000">: </span>

<span style="color: #001080">npx</span><span style="color: #000000"> </span><span style="color: #001080">ts</span><span style="color: #000000">-</span><span style="color: #001080">node</span><span style="color: #000000"> </span><span style="color: #001080">src</span><span style="color: #000000">/</span><span style="color: #001080">index</span><span style="color: #000000">.</span><span style="color: #001080">ts</span><span style="color: #000000"> </span><span style="color: #001080">add</span><span style="color: #000000"> --</span><span style="color: #001080">user</span><span style="color: #000000">=</span><span style="color: #A31515">&quot;edusegre&quot;</span><span style="color: #000000"> --</span><span style="color: #001080">title</span><span style="color: #000000">=</span><span style="color: #A31515">&quot;Test note&quot;</span><span style="color: #000000"> --</span><span style="color: #001080">body</span><span style="color: #000000">=</span><span style="color: #A31515">&quot;This is a test note&quot;</span><span style="color: #000000"> --</span><span style="color: #001080">color</span><span style="color: #000000">=</span><span style="color: #A31515">&quot;green&quot;</span>
<span style="color: #001080">New</span><span style="color: #000000"> </span><span style="color: #001080">note</span><span style="color: #000000"> </span><span style="color: #001080">added</span><span style="color: #000000">!</span>

<span style="color: #001080">Terminal</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000">:</span>

<span style="color: #001080">File</span><span style="color: #000000"> </span><span style="color: #001080">index</span><span style="color: #000000">.</span><span style="color: #001080">json</span><span style="color: #000000"> </span><span style="color: #001080">was</span><span style="color: #000000"> </span><span style="color: #001080">modified</span>
<span style="color: #001080">File</span><span style="color: #000000"> </span><span style="color: #001080">index</span><span style="color: #000000">.</span><span style="color: #001080">json</span><span style="color: #000000"> </span><span style="color: #001080">was</span><span style="color: #000000"> </span><span style="color: #001080">modified</span>
<span style="color: #001080">File</span><span style="color: #000000"> </span><span style="color: #001080">Test_note</span><span style="color: #000000">.</span><span style="color: #001080">json</span><span style="color: #000000"> </span><span style="color: #001080">was</span><span style="color: #000000"> </span><span style="color: #001080">modified</span>
<span style="color: #001080">File</span><span style="color: #000000"> </span><span style="color: #001080">Test_note</span><span style="color: #000000">.</span><span style="color: #001080">json</span><span style="color: #000000"> </span><span style="color: #001080">was</span><span style="color: #000000"> </span><span style="color: #001080">modified</span>
<span style="color: #001080">File</span><span style="color: #000000"> </span><span style="color: #001080">Test_note</span><span style="color: #000000">.</span><span style="color: #001080">json</span><span style="color: #000000"> </span><span style="color: #001080">was</span><span style="color: #000000"> </span><span style="color: #001080">created</span>
</code></pre>
				<p>Podemos ver en este caso, como se ha creado con éxito una nueva nota y hemos podido observar los cambios ocurridos sobre ese directorio. Ahora vamos a intentar eliminar esta nota para ver qué ocurre:</p>
				<pre><code><span style="color: #001080">Terminal</span><span style="color: #000000"> </span><span style="color: #098658">2</span><span style="color: #000000">: </span>

<span style="color: #001080">npx</span><span style="color: #000000"> </span><span style="color: #001080">ts</span><span style="color: #000000">-</span><span style="color: #001080">node</span><span style="color: #000000"> </span><span style="color: #001080">src</span><span style="color: #000000">/</span><span style="color: #001080">index</span><span style="color: #000000">.</span><span style="color: #001080">ts</span><span style="color: #000000"> </span><span style="color: #001080">remove</span><span style="color: #000000"> --</span><span style="color: #001080">user</span><span style="color: #000000">=</span><span style="color: #A31515">&quot;edusegre&quot;</span><span style="color: #000000"> --</span><span style="color: #001080">title</span><span style="color: #000000">=</span><span style="color: #A31515">&quot;Test note&quot;</span>
<span style="color: #001080">Correctly</span><span style="color: #000000"> </span><span style="color: #001080">removed</span>

<span style="color: #001080">Terminal</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000">:</span>

<span style="color: #001080">File</span><span style="color: #000000"> </span><span style="color: #001080">Test_note</span><span style="color: #000000">.</span><span style="color: #001080">json</span><span style="color: #000000"> </span><span style="color: #001080">was</span><span style="color: #000000"> </span><span style="color: #001080">modified</span>
<span style="color: #001080">File</span><span style="color: #000000"> </span><span style="color: #001080">Test_note</span><span style="color: #000000">.</span><span style="color: #001080">json</span><span style="color: #000000"> </span><span style="color: #001080">was</span><span style="color: #000000"> </span><span style="color: #001080">deleted</span>
<span style="color: #001080">File</span><span style="color: #000000"> </span><span style="color: #001080">index</span><span style="color: #000000">.</span><span style="color: #001080">json</span><span style="color: #000000"> </span><span style="color: #001080">was</span><span style="color: #000000"> </span><span style="color: #001080">modified</span>
</code></pre>
				<p>Como debía pasar, la nota fue correctamente eliminada, y pudimos observar desde nuestra terminal los cambios que se produjeron en el directorio que estábamos observando. </p>
				<p>Ahora podemos responder a las preguntas que se nos formulan en el guión de la práctica:</p>
				<ul>
					<li>¿Cómo haría para mostrar, no solo el nombre, sino también el contenido del fichero, en el caso de que haya sido creado o modificado?</li>
				</ul>
				<p>La respuesta es hacer un readfile al fichero cuando se crea o cuando se modifica, es decir, leemos el fichero primero y en caso de que no haya un error imprimimos el contenido.</p>
				<ul>
					<li>¿Cómo haría para que no solo se observase el directorio de un único usuario sino todos los directorios correspondientes a los diferentes usuarios de la aplicación de notas?</li>
				</ul>
				<p>Para poder realizar esto, tendríamos que indicarle el directorio donde se van a encontrar todos los directorios de la notas de los usuarios e indicarle la opción <strong>recursive</strong>. Le mandas un objeto con recursive y si el recursive es true va a escuchar todos los ficheros que cuelgan de este directorio donde están las carpetas del usuario.</p>
				<a href="#-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------3" id="-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------3" style="color: inherit; text-decoration: none;">
					<h1>------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</h1>
				</a>
				<a href="#--gt-ejercicio-4" id="--gt-ejercicio-4" style="color: inherit; text-decoration: none;">
					<h4>--&gt; Ejercicio 4</h4>
				</a>
				<p>Finalmente, para este ejercicio vamos a crear una aplicación que permita hacer de wrapper de los distintos comandos empleados en Linux para el manejo de ficheros y directorios. En concreto, la aplicación deberá permitir:</p>
				<ol>
					<li>Dada una ruta concreta, mostrar si es un directorio o un fichero <code>(comando stat)</code>.</li>
					<li>Crear un nuevo directorio a partir de una nueva ruta que recibe como parámetro <code>(comando mkdir)</code>.</li>
					<li>Listar los ficheros dentro de un directorio <code>(comando list)</code>.</li>
					<li>Mostrar el contenido de un fichero <code>(comando cat)</code>.</li>
					<li>Borrar ficheros y directorios <code>(comando rm)</code>.</li>
					<li>Mover y copiar ficheros y/o directorios de una ruta a otra. Para este caso, la aplicación recibirá una ruta origen y una ruta destino. En caso de que la ruta origen represente un directorio, se debe copiar dicho directorio y todo su contenido a la ruta destino <code>(comando cp)</code>.</li>
				</ol>
				<p>Para interactuar con la aplicación a través de la línea de comandos vamos a requerir de yargs.</p>
				<p>Como en los ejercicios anteriores, con yargs podremos definir una serie de comandos, estos serán los siguientes:</p>
				<ul>
					<li>stat</li>
					<li>mkdir</li>
					<li>ls</li>
					<li>cat</li>
					<li>rm</li>
					<li>cp</li>
				</ul>
				<p>Todos ellos, a excepción del comando <code>cp</code> van a requerir de un único parámetro, que será la ruta del fichero o directorio destino para aplicar estos comandos. Por su parte, <strong>cp</strong> va a necesitar no solo la ruta de origen sino también una ubicación de destino. Además, va a usar una función llamada <code>recursiveCopy</code> que nos va a permitir un directorio que tenga contenido en su interior de forma recursiva.</p>
				<p>recursiveCopy(origin: string, destiny: string) recibe como parámetros la ruta de origen y la de destino. Esta llama a la función stat, que tiene la dirección de origen y un callback de error en caso de que algo estuviera mal y de stats, que va a revisar si es un directorio. En caso de no serlo, será un fichero por lo que no va a necesitar que lo copien recursivamente y se hará uso de la función <code>copyFile</code> que tendrá la ruta de destino, así com unas callbacks en caso de que algo vaya mal.</p>
				<p>Suponiendo que se trata de un directorio, llamamos a <code>basename</code> que va  tener la ruta de origen y luego vamos a crear una nueva variable que al hacer un <code>join</code> con la dirección de destino y el fileName, llamaremos a <code>mkdir</code> para que la cree. Si algo sale mal, saltará la callback de error. También puede pasar que exista un problema al leer el contenido con <code>readdir</code> para poder copiarlo luego, es por ello que debemos preveer también el posible error lanzando un mensaje con un problema listando el contenido.
				Finalmente, si llegamos al <code>forof</code> de la línea 21, recorremoscada uno de los files y hacemos que la función se llame así misma para realizar la copia recursiva en el directorio de destino. Esto podemos verlo en el código siguiente correspondiente a la función que acabamos de analizar: </p>
				<pre><code><span style="color: #795E26">stat</span><span style="color: #000000">(</span><span style="color: #001080">origin</span><span style="color: #000000">, (</span><span style="color: #001080">err</span><span style="color: #000000">, </span><span style="color: #001080">stats</span><span style="color: #000000">) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #001080">err</span><span style="color: #000000">) {</span>
<span style="color: #000000">      </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;Error!&#039;</span><span style="color: #000000">);</span>
<span style="color: #000000">    } </span><span style="color: #AF00DB">else</span><span style="color: #000000"> {</span>
<span style="color: #000000">      </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #001080">stats</span><span style="color: #000000">.</span><span style="color: #795E26">isDirectory</span><span style="color: #000000">()) {</span>
<span style="color: #000000">        </span><span style="color: #0000FF">let</span><span style="color: #000000"> </span><span style="color: #001080">fileName</span><span style="color: #000000"> = </span><span style="color: #795E26">basename</span><span style="color: #000000">(</span><span style="color: #001080">origin</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #0000FF">let</span><span style="color: #000000"> </span><span style="color: #001080">newFolder</span><span style="color: #000000"> = </span><span style="color: #795E26">join</span><span style="color: #000000">(</span><span style="color: #001080">destiny</span><span style="color: #000000">, </span><span style="color: #001080">fileName</span><span style="color: #000000">);</span>
<span style="color: #000000">        </span><span style="color: #795E26">mkdir</span><span style="color: #000000">(</span><span style="color: #001080">newFolder</span><span style="color: #000000">, (</span><span style="color: #001080">err</span><span style="color: #000000">) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">          </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #001080">err</span><span style="color: #000000">) {</span>
<span style="color: #000000">            </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;Error while copying&#039;</span><span style="color: #000000">);</span>
<span style="color: #000000">          } </span><span style="color: #AF00DB">else</span><span style="color: #000000"> {</span>
<span style="color: #000000">            </span><span style="color: #795E26">readdir</span><span style="color: #000000">(</span><span style="color: #001080">origin</span><span style="color: #000000">, (</span><span style="color: #001080">err</span><span style="color: #000000">, </span><span style="color: #001080">files</span><span style="color: #000000">) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">              </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #001080">err</span><span style="color: #000000">) {</span>
<span style="color: #000000">                </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;Error listing the content&#039;</span><span style="color: #000000">);</span>
<span style="color: #000000">              } </span><span style="color: #AF00DB">else</span><span style="color: #000000"> {</span>
<span style="color: #000000">                </span><span style="color: #AF00DB">for</span><span style="color: #000000"> (</span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">file</span><span style="color: #000000"> </span><span style="color: #0000FF">of</span><span style="color: #000000"> </span><span style="color: #001080">files</span><span style="color: #000000">) {</span>
<span style="color: #000000">                  </span><span style="color: #795E26">recursiveCopy</span><span style="color: #000000">(</span><span style="color: #795E26">join</span><span style="color: #000000">(</span><span style="color: #001080">newFolder</span><span style="color: #000000">, </span><span style="color: #001080">file</span><span style="color: #000000">), </span><span style="color: #795E26">join</span><span style="color: #000000">(</span><span style="color: #001080">origin</span><span style="color: #000000">, </span><span style="color: #001080">file</span><span style="color: #000000">));</span>
<span style="color: #000000">                }</span>
<span style="color: #000000">              }</span>
<span style="color: #000000">            })</span>
<span style="color: #000000">          }</span>
<span style="color: #000000">        });</span>
<span style="color: #000000">      } </span><span style="color: #AF00DB">else</span><span style="color: #000000"> {</span>
<span style="color: #000000">        </span><span style="color: #795E26">stat</span><span style="color: #000000">(</span><span style="color: #001080">destiny</span><span style="color: #000000">, (</span><span style="color: #001080">err</span><span style="color: #000000">, </span><span style="color: #001080">stats</span><span style="color: #000000">) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">          </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #001080">err</span><span style="color: #000000">) {</span>
<span style="color: #000000">            </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #001080">err</span><span style="color: #000000">.</span><span style="color: #001080">code</span><span style="color: #000000"> === </span><span style="color: #A31515">&#039;ENOENT&#039;</span><span style="color: #000000">) {</span>
<span style="color: #000000">              </span><span style="color: #795E26">copyFile</span><span style="color: #000000">(</span><span style="color: #001080">origin</span><span style="color: #000000">, </span><span style="color: #001080">destiny</span><span style="color: #000000">, (</span><span style="color: #001080">err</span><span style="color: #000000">) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">                </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #001080">err</span><span style="color: #000000">) {</span>
<span style="color: #000000">                  </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;Error while copying 34&#039;</span><span style="color: #000000">);</span>
<span style="color: #000000">                }</span>
<span style="color: #000000">              })</span>
<span style="color: #000000">            }</span>
<span style="color: #000000">            </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;Error&#039;</span><span style="color: #000000">);</span>
<span style="color: #000000">          } </span><span style="color: #AF00DB">else</span><span style="color: #000000"> {</span>
<span style="color: #000000">            </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #001080">stats</span><span style="color: #000000">.</span><span style="color: #795E26">isDirectory</span><span style="color: #000000">()) {</span>
<span style="color: #000000">              </span><span style="color: #001080">destiny</span><span style="color: #000000"> = </span><span style="color: #795E26">join</span><span style="color: #000000">(</span><span style="color: #001080">destiny</span><span style="color: #000000">, </span><span style="color: #795E26">basename</span><span style="color: #000000">(</span><span style="color: #001080">origin</span><span style="color: #000000">));</span>
<span style="color: #000000">            }</span>
<span style="color: #000000">            </span><span style="color: #795E26">copyFile</span><span style="color: #000000">(</span><span style="color: #001080">origin</span><span style="color: #000000">, </span><span style="color: #001080">destiny</span><span style="color: #000000">, (</span><span style="color: #001080">err</span><span style="color: #000000">) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">              </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #001080">err</span><span style="color: #000000">) {</span>
<span style="color: #000000">                </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;Error while copying 45&#039;</span><span style="color: #000000">);</span>
<span style="color: #000000">              }</span>
</code></pre>
				<p>Finalmente, veamos algunos ejemplos de ejecución:</p>
				<pre><code><span style="color: #001080">node</span><span style="color: #000000"> </span><span style="color: #001080">src</span><span style="color: #000000">/</span><span style="color: #001080">exercise</span><span style="color: #000000">-4.</span><span style="color: #001080">js</span><span style="color: #000000"> </span><span style="color: #001080">stat</span><span style="color: #000000"> --</span><span style="color: #001080">route</span><span style="color: #000000"> </span><span style="color: #001080">src</span>
<span style="color: #001080">The</span><span style="color: #000000"> </span><span style="color: #001080">given</span><span style="color: #000000"> </span><span style="color: #001080">route</span><span style="color: #000000"> </span><span style="color: #001080">is</span><span style="color: #000000"> </span><span style="color: #001080">a</span><span style="color: #000000"> </span><span style="color: #001080">directory</span>

<span style="color: #001080">node</span><span style="color: #000000"> </span><span style="color: #001080">src</span><span style="color: #000000">/</span><span style="color: #001080">exercise</span><span style="color: #000000">-4.</span><span style="color: #001080">js</span><span style="color: #000000"> </span><span style="color: #001080">mkdir</span><span style="color: #000000"> --</span><span style="color: #001080">route</span><span style="color: #000000"> </span><span style="color: #001080">ejemplo</span>
<span style="color: #001080">Directory</span><span style="color: #000000"> </span><span style="color: #001080">created</span>

<span style="color: #001080">node</span><span style="color: #000000"> </span><span style="color: #001080">src</span><span style="color: #000000">/</span><span style="color: #001080">exercise</span><span style="color: #000000">-4.</span><span style="color: #001080">js</span><span style="color: #000000"> </span><span style="color: #001080">ls</span><span style="color: #000000"> --</span><span style="color: #001080">route</span><span style="color: #000000"> </span><span style="color: #001080">ejemplo</span>
<span style="color: #001080">Directory</span><span style="color: #000000"> content: </span>
</code></pre>
				<p>Ahora dentro de ejemplo vamos a crear dos ficheros:
					touch file1.txt
				touch file2.txt</p>
				<pre><code><span style="color: #001080">node</span><span style="color: #000000"> </span><span style="color: #001080">src</span><span style="color: #000000">/</span><span style="color: #001080">exercise</span><span style="color: #000000">-4.</span><span style="color: #001080">js</span><span style="color: #000000"> </span><span style="color: #001080">ls</span><span style="color: #000000"> --</span><span style="color: #001080">route</span><span style="color: #000000"> </span><span style="color: #001080">ejemplo</span>
<span style="color: #001080">Directory</span><span style="color: #000000"> content: </span>
<span style="color: #000000">        </span><span style="color: #001080">file1</span><span style="color: #000000">.</span><span style="color: #001080">txt</span>
<span style="color: #000000">        </span><span style="color: #001080">file2</span><span style="color: #000000">.</span><span style="color: #001080">txt</span>

<span style="color: #001080">node</span><span style="color: #000000"> </span><span style="color: #001080">src</span><span style="color: #000000">/</span><span style="color: #001080">exercise</span><span style="color: #000000">-4.</span><span style="color: #001080">js</span><span style="color: #000000"> </span><span style="color: #001080">cat</span><span style="color: #000000"> --</span><span style="color: #001080">route</span><span style="color: #000000"> </span><span style="color: #001080">ejemplo</span><span style="color: #000000">/</span><span style="color: #001080">file1</span><span style="color: #000000">.</span><span style="color: #001080">txt</span>
<span style="color: #001080">estos</span><span style="color: #000000"> </span><span style="color: #001080">es</span><span style="color: #000000"> </span><span style="color: #001080">el</span><span style="color: #000000"> </span><span style="color: #001080">ejemplo</span><span style="color: #000000"> </span><span style="color: #098658">1</span>

<span style="color: #001080">node</span><span style="color: #000000"> </span><span style="color: #001080">src</span><span style="color: #000000">/</span><span style="color: #001080">exercise</span><span style="color: #000000">-4.</span><span style="color: #001080">js</span><span style="color: #000000"> </span><span style="color: #001080">cp</span><span style="color: #000000"> --</span><span style="color: #001080">destinyRoute</span><span style="color: #000000"> </span><span style="color: #001080">ejemplo</span><span style="color: #000000"> --</span><span style="color: #001080">originRoute</span><span style="color: #000000"> </span><span style="color: #0070C1">README</span><span style="color: #000000">.</span><span style="color: #001080">md</span>

<span style="color: #001080">node</span><span style="color: #000000"> </span><span style="color: #001080">src</span><span style="color: #000000">/</span><span style="color: #001080">exercise</span><span style="color: #000000">-4.</span><span style="color: #001080">js</span><span style="color: #000000"> </span><span style="color: #001080">ls</span><span style="color: #000000"> --</span><span style="color: #001080">route</span><span style="color: #000000"> </span><span style="color: #001080">ejemplo</span>
<span style="color: #001080">Directory</span><span style="color: #000000"> content: </span>
<span style="color: #000000">        </span><span style="color: #0070C1">README</span><span style="color: #000000">.</span><span style="color: #001080">md</span>
<span style="color: #000000">        </span><span style="color: #001080">file1</span><span style="color: #000000">.</span><span style="color: #001080">txt</span>
<span style="color: #000000">        </span><span style="color: #001080">file2</span><span style="color: #000000">.</span><span style="color: #001080">txt</span>

<span style="color: #001080">node</span><span style="color: #000000"> </span><span style="color: #001080">src</span><span style="color: #000000">/</span><span style="color: #001080">exercise</span><span style="color: #000000">-4.</span><span style="color: #001080">js</span><span style="color: #000000"> </span><span style="color: #001080">rm</span><span style="color: #000000"> --</span><span style="color: #001080">route</span><span style="color: #000000"> </span><span style="color: #001080">ejemplo</span>
<span style="color: #001080">Deleted</span>
</code></pre>
				<a href="#integración-continua-de-typescript-y-nodejs-con-github-actions" id="integración-continua-de-typescript-y-nodejs-con-github-actions" style="color: inherit; text-decoration: none;">
					<h3>Integración continua de Typescript y Node.js con GitHub Actions</h3>
				</a>
				<ul>
					<li><a href="https://coveralls.io/github/ULL-ESIT-INF-DSI-2021/ull-esit-inf-dsi-20-21-prct09-async-fs-process-ostream07?branch=master"><img src="https://coveralls.io/repos/github/ULL-ESIT-INF-DSI-2021/ull-esit-inf-dsi-20-21-prct09-async-fs-process-ostream07/badge.svg?branch=master" alt="Coverage Status"></a></li>
				</ul>
				<ul>
					<li><a href="https://github.com/ULL-ESIT-INF-DSI-2021/ull-esit-inf-dsi-20-21-prct09-async-fs-process-ostream07/actions/workflows/node.js.yml"><img src="https://github.com/ULL-ESIT-INF-DSI-2021/ull-esit-inf-dsi-20-21-prct09-async-fs-process-ostream07/actions/workflows/node.js.yml/badge.svg" alt="Test"></a></li>
				</ul>
				<ul>
					<li><a href="https://sonarcloud.io/dashboard?id=ULL-ESIT-INF-DSI-2021_ull-esit-inf-dsi-20-21-prct09-async-fs-process-ostream07"><img src="https://sonarcloud.io/api/project_badges/quality_gate?project=ULL-ESIT-INF-DSI-2021_ull-esit-inf-dsi-20-21-prct09-async-fs-process-ostream07" alt="Quality gate"></a></li>
				</ul>
				<p>// <a href="http://juandarodriguez.es/event-loop.html">http://juandarodriguez.es/event-loop.html</a>
					/* <a href="http://latentflip.com/loupe/?code=aW1wb3J0IHsgYWNjZXNzLCBjb25zdGFudHMsIHdhdGNoIH0gZnJvbSAnZnMnOw0KDQppZiAocHJvY2Vzcy5hcmd2Lmxlbmd0aCAhPT0gMykgew0KICBjb25zb2xlLmxvZygnUGxlYXNlLCBzcGVjaWZ5IGEgZmlsZScpOw0KfSBlbHNlIHsNCiAgY29uc3QgZmlsZW5hbWUgPSBwcm9jZXNzLmFyZ3ZbMl07DQoNCiAgYWNjZXNzKGZpbGVuYW1lLCBjb25zdGFudHMuRl9PSywgKGVycikgPT4gew0KICAgIGlmIChlcnIpIHsNCiAgICAgIGNvbnNvbGUubG9nKGBGaWxlICR7ZmlsZW5hbWV9IGRvZXMgbm90IGV4aXN0YCk7DQogICAgfSBlbHNlIHsNCiAgICAgIGNvbnNvbGUubG9nKGBTdGFydGluZyB0byB3YXRjaCBmaWxlICR7ZmlsZW5hbWV9YCk7DQoNCiAgICAgIGNvbnN0IHdhdGNoZXIgPSB3YXRjaChwcm9jZXNzLmFyZ3ZbMl0pOw0KDQogICAgICB3YXRjaGVyLm9uKCdjaGFuZ2UnLCAoKSA9PiB7DQogICAgICAgIGNvbnNvbGUubG9nKGBGaWxlICR7ZmlsZW5hbWV9IGhhcyBiZWVuIG1vZGlmaWVkIHNvbWVob3dgKTsNCiAgICAgIH0pOw0KDQogICAgICBjb25zb2xlLmxvZyhgRmlsZSAke2ZpbGVuYW1lfSBpcyBubyBsb25nZXIgd2F0Y2hlZGApOw0KICAgIH0NCiAgfSk7DQp9!!!PGJ1dHRvbj5DbGljayBtZSE8L2J1dHRvbj4%3D">http://latentflip.com/loupe/?code=aW1wb3J0IHsgYWNjZXNzLCBjb25zdGFudHMsIHdhdGNoIH0gZnJvbSAnZnMnOw0KDQppZiAocHJvY2Vzcy5hcmd2Lmxlbmd0aCAhPT0gMykgew0KICBjb25zb2xlLmxvZygnUGxlYXNlLCBzcGVjaWZ5IGEgZmlsZScpOw0KfSBlbHNlIHsNCiAgY29uc3QgZmlsZW5hbWUgPSBwcm9jZXNzLmFyZ3ZbMl07DQoNCiAgYWNjZXNzKGZpbGVuYW1lLCBjb25zdGFudHMuRl9PSywgKGVycikgPT4gew0KICAgIGlmIChlcnIpIHsNCiAgICAgIGNvbnNvbGUubG9nKGBGaWxlICR7ZmlsZW5hbWV9IGRvZXMgbm90IGV4aXN0YCk7DQogICAgfSBlbHNlIHsNCiAgICAgIGNvbnNvbGUubG9nKGBTdGFydGluZyB0byB3YXRjaCBmaWxlICR7ZmlsZW5hbWV9YCk7DQoNCiAgICAgIGNvbnN0IHdhdGNoZXIgPSB3YXRjaChwcm9jZXNzLmFyZ3ZbMl0pOw0KDQogICAgICB3YXRjaGVyLm9uKCdjaGFuZ2UnLCAoKSA9PiB7DQogICAgICAgIGNvbnNvbGUubG9nKGBGaWxlICR7ZmlsZW5hbWV9IGhhcyBiZWVuIG1vZGlmaWVkIHNvbWVob3dgKTsNCiAgICAgIH0pOw0KDQogICAgICBjb25zb2xlLmxvZyhgRmlsZSAke2ZpbGVuYW1lfSBpcyBubyBsb25nZXIgd2F0Y2hlZGApOw0KICAgIH0NCiAgfSk7DQp9!!!PGJ1dHRvbj5DbGljayBtZSE8L2J1dHRvbj4%3D</a>
					*/
				// <a href="https://geekflare.com/es/javascript-event-loops/">https://geekflare.com/es/javascript-event-loops/</a></p>
			</div>
		</div>
		<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul>
					<li class=" ">
						<a href="modules.html">Modules</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/exercise_1.html">exercise-<wbr>1</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/exercise_2.html">exercise-<wbr>2</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/exercise_3.html">exercise-<wbr>3</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/exercise_4.html">exercise-<wbr>4</a>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
				</ul>
			</nav>
		</div>
	</div>
</div>
<footer class="with-border-bottom">
	<div class="container">
		<h2>Legend</h2>
		<div class="tsd-legend-group">
		</div>
	</div>
</footer>
<div class="container tsd-generator">
	<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p>
</div>
<div class="overlay"></div>
<script src="assets/js/main.js"></script>
</body>
</html>